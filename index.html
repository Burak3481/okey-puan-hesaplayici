<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Okey Puan Hesaplayıcı</title>

<!-- Cache'i devre dışı bırak -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<style>
body { font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif; background:#f2f2f7; margin:0; padding:0; color:#333;}
.container { background:white; padding:20px; border-radius:12px; max-width:750px; margin:20px auto; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
h1 { color:#007AFF; text-align:center; margin-bottom:15px;}
label { font-weight:600; display:block; margin-top:10px;}
input, select, button { width:100%; padding:10px; margin-top:5px; border-radius:8px; border:1px solid #ccc; font-size:15px; box-sizing:border-box;}
button { background:#007AFF; color:white; font-weight:bold; border:none; cursor:pointer; transition:0.2s;}
button:hover { background:#005BBB;}
button:disabled { background:#ccc; cursor:not-allowed;}
#puanTablosu { width:100%; border-collapse:collapse; margin-top:15px;}
#puanTablosu th,#puanTablosu td { border:1px solid #ddd; padding:8px; text-align:center;}
#puanTablosu th { background:#007AFF; color:white;}
tfoot td { font-weight:bold; background:#eee;}
.plus { color:#1AAE55; font-weight:bold;}
.minus { color:#FF3B30; font-weight:bold;}
#kazanan { background:#e5f8e0; border:1px solid #b3e5a3; padding:15px; border-radius:12px; margin-top:15px; display:none; text-align:center; font-size:1.2em; font-weight:bold; color:#1AAE55; opacity:0; transform:scale(0.8); transition:all 0.5s ease;}
#kazanan.show { display:block; opacity:1; transform:scale(1);}
#resetBtn { background:#FF3B30; margin-top:8px;}
.deleteBtn { background:#FF3B30; color:white; border:none; padding:6px 8px; border-radius:6px; cursor:pointer; font-size:0.8em;}
.deleteBtn:hover { background:#cc0000;}
.siyah { background-color:#d9d9d9;}
.kirmizi { background-color:#ffd6d6;}
.mavi { background-color:#d6e0ff;}
.sari { background-color:#fff6d6;}
#kimseBitmediAlani { display:none; margin-top:10px;}
</style>
</head>
<body>
<div class="container">
  <h1>🧮 Okey Puan Hesaplayıcı</h1>

  <label>Takım İsimleri:</label>
  <input type="text" id="takimAIsim" value="Takım A">
  <input type="text" id="takimBIsim" value="Takım B">
  <button onclick="takimGuncelle()">Takımları Güncelle</button>

  <label>Biten Takım:</label>
  <select id="bitenTakim" onchange="bitenDegisti()">
    <option value="A">Takım A</option>
    <option value="B">Takım B</option>
    <option value="yok">Kimse Bitmedi</option>
  </select>

  <label>Okey Rengi:</label>
  <select id="okeyRenk">
    <option value="siyah">Siyah</option>
    <option value="kirmizi">Kırmızı</option>
    <option value="mavi">Mavi</option>
    <option value="sari">Sarı</option>
  </select>

  <div id="tekliAlan">
    <label>Karşı Takımın Per Olmayan Taş Toplamı:</label>
    <input type="number" id="perOlmayanToplam" placeholder="örn. 45">
  </div>

  <div id="kimseBitmediAlani">
    <label id="lblA">Takım A Per Olmayan Taş Toplamı:</label>
    <input type="number" id="tasA" placeholder="örn. 45">
    <label id="lblB">Takım B Per Olmayan Taş Toplamı:</label>
    <input type="number" id="tasB" placeholder="örn. 60">
  </div>

  <label>Biten taraf okey ile mi bitti?</label>
  <select id="okeyBitis">
    <option value="hayir">Hayır</option>
    <option value="okey">Evet (Okey ile)</option>
  </select>

  <button onclick="elEkle()">Eli Ekle</button>
  <button id="resetBtn" onclick="sifirla()">Yeni Parti</button>

  <table id="puanTablosu">
    <thead>
      <tr>
        <th>El</th><th>Biten</th><th>Renk</th><th>Durum</th>
        <th id="baslikA">A Puan</th><th id="baslikB">B Puan</th><th>🗑️</th>
      </tr>
    </thead>
    <tbody></tbody>
    <tfoot>
      <tr><td colspan="4">Toplam</td><td id="toplamA">0</td><td id="toplamB">0</td><td></td></tr>
    </tfoot>
  </table>

  <div id="kazanan"></div>
</div>

<script>
let elSayisi=0, toplamA=0, toplamB=0;
const maxEl=11;
const renkKatsayi={siyah:5,kirmizi:4,mavi:3,sari:2};

function takimGuncelle(){
  const a=document.getElementById("takimAIsim").value||"Takım A";
  const b=document.getElementById("takimBIsim").value||"Takım B";
  const sel=document.getElementById("bitenTakim");
  sel.options[0].text=a; sel.options[1].text=b;
  document.getElementById("lblA").innerText=a+" Per Olmayan Taş Toplamı:";
  document.getElementById("lblB").innerText=b+" Per Olmayan Taş Toplamı:";
  document.getElementById("baslikA").innerText=a+" Puan";
  document.getElementById("baslikB").innerText=b+" Puan";
}

function bitenDegisti(){
  const val=document.getElementById("bitenTakim").value;
  document.getElementById("tekliAlan").style.display=val==="yok"?"none":"block";
  document.getElementById("kimseBitmediAlani").style.display=val==="yok"?"block":"none";
}

function hesapla(biten, renk, tas, okey){
  const k=renkKatsayi[renk];
  if(biten==="yok"){
    const puanA = tas.a*k;
    const puanB = tas.b*k;
    return {a:puanA, b:puanB, durum:"Kimse Bitmedi"};
  }
  const perToplam = tas;
  const yanik = perToplam>=100;
  let bitenDus = 10*k;
  let digerEkle = perToplam*k;
  if(okey==="okey"){ bitenDus*=2; digerEkle*=2; }
  if(yanik){ bitenDus=100*k; digerEkle=100*k; }
  if(yanik && okey==="okey"){ bitenDus=100*k; digerEkle=200*k; }
  if(biten==="A") return {a:-bitenDus, b:digerEkle, durum:yanik?(okey==="okey"?"YANIK+OKEY":"YANIK"):(okey==="okey"?"OKEY":"Normal")};
  else return {a:digerEkle, b:-bitenDus, durum:yanik?(okey==="okey"?"YANIK+OKEY":"YANIK"):(okey==="okey"?"OKEY":"Normal")};
}

function elEkle(){
  if(elSayisi>=maxEl){ alert("11 el tamamlandı!"); return; }
  const biten=document.getElementById("bitenTakim").value;
  const renk=document.getElementById("okeyRenk").value;
  const okey=document.getElementById("okeyBitis").value;
  let sonuc;
  if(biten==="yok"){
    const ta=parseInt(document.getElementById("tasA").value);
    const tb=parseInt(document.getElementById("tasB").value);
    if(isNaN(ta)||isNaN(tb)){alert("İki takımın taş toplamlarını giriniz!");return;}
    sonuc=hesapla("yok",renk,{a:ta,b:tb},okey);
  }else{
    const per=parseInt(document.getElementById("perOlmayanToplam").value);
    if(isNaN(per)){alert("Per olmayan taş toplamını giriniz!");return;}
    sonuc=hesapla(biten,renk,per,okey);
  }

  elSayisi++;
  toplamA+=sonuc.a; toplamB+=sonuc.b;

  const tbody=document.querySelector("#puanTablosu tbody");
  const row=document.createElement("tr");
  row.className=renk;
  row.dataset.a=sonuc.a; row.dataset.b=sonuc.b;
  row.innerHTML=`
    <td>${elSayisi}</td>
    <td>${biten==="yok"?"Kimse Bitmedi":document.getElementById("bitenTakim").options[document.getElementById("bitenTakim").selectedIndex].text}</td>
    <td>${renk.toUpperCase()}</td>
    <td>${sonuc.durum}</td>
    <td class="${sonuc.a>=0?'plus':'minus'}">${sonuc.a>0?'+':''}${sonuc.a}</td>
    <td class="${sonuc.b>=0?'plus':'minus'}">${sonuc.b>0?'+':''}${sonuc.b}</td>
    <td><button class="deleteBtn" onclick="elSil(this)">Sil</button></td>`;
  tbody.appendChild(row);
  document.getElementById("toplamA").innerText=toplamA;
  document.getElementById("toplamB").innerText=toplamB;
  if(elSayisi===maxEl) kazanan();
}

function elSil(btn){
  const tr=btn.closest("tr");
  toplamA-=Number(tr.dataset.a); toplamB-=Number(tr.dataset.b);
  tr.remove(); elSayisi--;
  document.getElementById("toplamA").innerText=toplamA;
  document.getElementById("toplamB").innerText=toplamB;
  document.getElementById("kazanan").classList.remove("show");
}

function sifirla(){
  elSayisi=0; toplamA=0; toplamB=0;
  document.querySelector("#puanTablosu tbody").innerHTML="";
  document.getElementById("toplamA").innerText="0";
  document.getElementById("toplamB").innerText="0";
  document.getElementById("kazanan").classList.remove("show");
  document.getElementById("kazanan").innerText="";
}

function kazanan(){
  const a=document.getElementById("takimAIsim").value||"Takım A";
  const b=document.getElementById("takimBIsim").value||"Takım B";
  const div=document.getElementById("kazanan");
  if(toplamA<toplamB) div.innerText=`🏆 Kazanan: ${a} (${toplamA} - ${toplamB})`;
  else if(toplamB<toplamA) div.innerText=`🏆 Kazanan: ${b} (${toplamB} - ${toplamA})`;
  else div.innerText=`🤝 Berabere! (${toplamA} - ${toplamB})`;
  div.classList.add("show");
}
</script>
</body>
</html>
